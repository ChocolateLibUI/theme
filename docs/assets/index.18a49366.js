var K=Object.defineProperty;var W=(i,t,e)=>t in i?K(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>(W(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const Q="modulepreload",X=function(i,t){return new URL(i,t).href},C={},w=function(t,e,s){if(!e||e.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(e.map(r=>{if(r=X(r,s),r in C)return;C[r]=!0;const a=r.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!s)for(let l=n.length-1;l>=0;l--){const m=n[l];if(m.href===r&&(!a||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${u}`))return;const o=document.createElement("link");if(o.rel=a?"stylesheet":Q,a||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),a)return new Promise((l,m)=>{o.addEventListener("load",l),o.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())};let _=[],Y=async i=>{_.includes(i)?console.warn("Document registered with theme engine twice"):(_.push(i),(await w(()=>Promise.resolve().then(()=>U),void 0,import.meta.url)).applyTheme(i,await(await w(()=>Promise.resolve().then(()=>U),void 0,import.meta.url)).theme.get),(await w(()=>Promise.resolve().then(()=>ae),void 0,import.meta.url)).initTouch(i),(await w(()=>Promise.resolve().then(()=>oe),void 0,import.meta.url)).initScale(i))};Y(document);let B=(i,t)=>{var s;let e=new TextEncoder().encode(i);return i=new TextDecoder().decode(e.slice(0,t)),((s=i.at(-1))==null?void 0:s.charCodeAt(0))===65533?i.slice(0,-1):i};class S{constructor(t){h(this,"___valueListeners",[]);h(this,"___value");h(this,"info");this.___value=t}addListener(t,e){if(this.___valueListeners.push(t),e){let s=this.get;s instanceof Promise?s.then(t):t(s)}return t}removeListener(t){let e=this.___valueListeners.indexOf(t);return e!=-1&&this.___valueListeners.splice(e,1),t}get get(){return this.___value}set set(t){this.___value!==t&&(this.___value=t,this.___update())}___update(){if(this.___valueListeners)for(let t=0,e=this.___valueListeners.length;t<e;t++)try{this.___valueListeners[t](this.___value)}catch(s){console.warn("Failed while calling value listeners ",s)}}compare(t){let e=this.get;return e instanceof Promise?e.then(s=>t!==s):t!==e}get inUse(){return this.___valueListeners.length!==0}hasListener(t){return this.___valueListeners.indexOf(t)!==-1}toJSON(){return this.___value}}class R extends S{constructor(e,s){super(e);h(this,"___limiters");h(this,"___limitersListeners",[]);this.___limiters=s}addLimiterListener(e,s){return this.___limitersListeners.push(e),s&&e(this),e}removeLimiterListener(e){let s=this.___limitersListeners.indexOf(e);return s!=-1&&this.___limitersListeners.splice(s,1),e}___updateLimiter(){if(this.___limitersListeners)for(let e=0,s=this.___limitersListeners.length;e<s;e++)try{this.___limitersListeners[e](this)}catch(n){console.warn("Failed while calling value listeners ",n)}}get limiters(){return this.___limiters}set limiters(e){e?this.___limiters=e:delete this.___limiters,this.___updateLimiter()}checkLimit(e){if(this.___limiters){for(let s=0;s<this.___limiters.length;s++)if(this.___limiters[s].func(e))return!1}return!0}checkLimitReason(e){if(this.___limiters){for(let s=0;s<this.___limiters.length;s++)if(this.___limiters[s].func(e))switch(typeof this.___limiters[s].reason){case"string":return this.___limiters[s].reason;case"function":return this.___limiters[s].reason(e)}}return!0}set set(e){e===this.___value||!this.checkLimit(e)||(this.___value=e,this.___update())}}class T extends R{constructor(e,s=-1/0,n=1/0,r,a){super(e,a);h(this,"_min");h(this,"_max");h(this,"_step");h(this,"halfStep",0);this._min=s,this._max=n,r&&(this._step=r,this.halfStep=r/2)}get min(){return this._min}set min(e){this._min=e;let s=Math.max(this._min,this.___value);this.___value!==s&&(this.___value=s,this.___update()),this.___updateLimiter()}get max(){return this._max}set max(e){this._max=e;let s=Math.min(this._max,this.___value);this.___value!==s&&(this.___value=s,this.___update()),this.___updateLimiter()}get step(){return this._step}set step(e){if(e){this._step=e,this.halfStep=e/2;let s=this.___value%this._step,n=s>this.halfStep?this.___value+(this._step-s):this.___value-s;n!==this.___value&&(this.___value=n,this.___update())}else delete this._step,this.halfStep=0;this.___updateLimiter()}set set(e){if(this._step){let s=e%this._step;e=s>this.halfStep?e+(this._step-s):e-s}e=Math.min(this._max,Math.max(this._min,e)),e!==this.___value&&this.checkLimit(e)&&(this.___value=e,this.___update())}}class k extends R{constructor(e,s,n,r,a){super(e,a);h(this,"_maxLength");h(this,"_maxByteLength");h(this,"___enums");this._maxLength=n,this._maxByteLength=r,this.___enums=s}get enums(){return this.___enums}set enums(e){if(e){if(this.___enums=e,!this.checkEnum(this.___value))for(const s in this.___enums){this.___value=s,this.___update();return}}else delete this.___enums;this.___updateLimiter()}get enum(){if(this.___enums)return this.___enums[this.___value]}checkEnum(e){return!this.___enums||e in this.___enums}get maxLength(){return this._maxLength}set maxLength(e){this._maxLength=e,this._maxLength&&this.___value.length>this._maxLength&&(this.___value=this.___value.slice(0,this._maxLength),this.___update()),this.___updateLimiter()}get maxByteLength(){return this._maxByteLength}set maxByteLength(e){if(this._maxByteLength=e,this._maxByteLength){let s=B(this.___value,this._maxByteLength);this.___value!==s&&(this.___value=s,this.___update())}this.___updateLimiter()}set set(e){this._maxLength&&e.length>this._maxLength&&(e=e.slice(0,this._maxLength)),this._maxByteLength&&(e=B(e,this._maxByteLength)),e!==this.___value&&this.checkLimit(e)&&this.checkEnum(e)&&(this.___value=e,this.___update())}}var Z=Object.defineProperty,ee=(i,t,e)=>t in i?Z(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,p=(i,t,e)=>(ee(i,typeof t!="symbol"?t+"":t,e),e);let N={},te=(i,t,e)=>(N[i]=new I(i,t,e),N[i]);class I{constructor(t,e,s){p(this,"pathID"),p(this,"settings",{}),p(this,"subGroups",{}),p(this,"name"),p(this,"description"),this.pathID=t,this.name=e,this.description=s}makeSubGroup(t,e,s){if(t in this.subGroups){console.warn("Sub group already registered "+t);return}else return this.subGroups[t]=new I(this.pathID+"/"+t,e,s)}makeBooleanSetting(t,e,s,n){if(t in this.settings)throw new Error("Settings already registered "+t);let r=localStorage[this.pathID+"/"+t];if(r)var a=new S(JSON.parse(r));else if(typeof n=="boolean")var a=new S(n);else{var a=new S(!1);n.then(c=>{a.set=c})}return a.info={name:e,description:s},a.addListener(u=>{localStorage[this.pathID+"/"+t]=JSON.stringify(u)},!r),this.settings[t]=a}makeNumberSetting(t,e,s,n,r,a,u,c){if(t in this.settings)throw new Error("Settings already registered "+t);let o=localStorage[this.pathID+"/"+t];if(o)var l=new T(JSON.parse(o),r,a,u,c);else if(typeof n=="number")var l=new T(n,r,a,u,c);else{var l=new T(NaN,r,a,u,c);n.then(E=>{l.set=E})}return l.info={name:e,description:s},l.addListener(m=>{localStorage[this.pathID+"/"+t]=JSON.stringify(m)},!o),this.settings[t]=l}makeStringSetting(t,e,s,n,r,a,u,c){if(t in this.settings)throw new Error("Settings already registered "+t);let o=localStorage[this.pathID+"/"+t];if(o)var l=new k(JSON.parse(o),r,a,u,c);else if(typeof n=="string")var l=new k(n,r,a,u,c);else{var l=new k("",r,a,u,c);n.then(E=>{l.set=E})}return l.info={name:e,description:s},l.addListener(m=>{localStorage[this.pathID+"/"+t]=JSON.stringify(m)},!o),this.settings[t]=l}}const ie="@chocolatelibui/theme";let y=te(ie,"Theme/UI","Settings for UI elements and and color themes"),se={light:{name:"Light",description:"Don't set touch mode automatically"},dark:{name:"Dark",description:"Change touch mode on first ui interaction"}},g=y.makeStringSetting("theme","Theme","Color theme of UI",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",se),b=y.makeBooleanSetting("autoTheme","Automatic Theme Change","Toggle for automatically changing theme",!0),D=async(i,t,e)=>{if(i in L.light)console.warn("Theme variable already registered "+i);else{L.light[i]=t,L.dark[i]=e;for(let s=0;s<_.length;s++)_[s].documentElement.style.setProperty("--"+i,L[await g.get][i])}},A=(i,t)=>{let e=i.documentElement.style,s=L[t];for(let n in s)e.setProperty("--"+n,s[n])};g.addListener(i=>{for(let t=0;t<_.length;t++)A(_[t],i)});let L={light:{},dark:{}};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{b.get&&(g.set=i.matches?"dark":"light")});const U=Object.freeze(Object.defineProperty({__proto__:null,theme:g,autoTheme:b,registerVariable:D,applyTheme:A},Symbol.toStringTag,{value:"Module"}));var P=(i=>(i.off="off",i.first="first",i.every="every",i))(P||{});let ne={off:{name:"Off",description:"Don't set touch mode automatically"},first:{name:"First Interaction",description:"Change touch mode on first ui interaction"},every:{name:"Every Interaction",description:"Change touch mode on every ui interaction"}},d=y.makeBooleanSetting("touch","Touch Mode","Toggle between touch friendly or mouse friendly UI",!1),v=y.makeStringSetting("autoTouch","Automatic Touch Mode","Mode for automatically changing touch mode","every",ne),re=i=>{V(i,d.get),j(i,v.get)};d.addListener(i=>{for(let t=0;t<_.length;t++)V(_[t],i)});v.addListener(i=>{for(let t=0;t<_.length;t++)j(_[t],i)});let V=(i,t)=>{t?i.documentElement.classList.add("touch"):i.documentElement.classList.remove("touch")},x=i=>{switch(i.pointerType){case"touch":d.set=!0;break;case"mouse":case"pen":default:d.set=!1;break}},O=i=>{x(i);for(let t=0;t<_.length;t++)_[t].documentElement.removeEventListener("pointerdown",O)},j=(i,t)=>{switch(i.documentElement.removeEventListener("pointerdown",O),i.documentElement.removeEventListener("pointerdown",x),t){case"first":i.documentElement.addEventListener("pointerdown",O,{passive:!0});break;case"every":i.documentElement.addEventListener("pointerdown",x,{passive:!0});break}};const ae=Object.freeze(Object.defineProperty({__proto__:null,AutoTouchMode:P,touch:d,autoTouch:v,initTouch:re},Symbol.toStringTag,{value:"Module"}));let f=y.makeNumberSetting("scale","UI Scale","The scale of the UI",1,.2,4),le=async i=>{J(i)},H=16;f.addListener(i=>{H=i*16;for(let t=0;t<_.length;t++)J(_[t])});let J=i=>{i.documentElement.style.fontSize=H+"px"};const oe=Object.freeze(Object.defineProperty({__proto__:null,scale:f,initScale:le},Symbol.toStringTag,{value:"Module"}));D("test","blue","black");D("test2","test","asdf");document.body.style.backgroundColor="var(--test)";let $=document.body.appendChild(document.createElement("button"));$.innerHTML="Turn Auto Theme Off";$.addEventListener("click",()=>{b.set=!1});let z=document.body.appendChild(document.createElement("button"));z.innerHTML="Turn Auto Theme On";z.addEventListener("click",()=>{b.set=!0});let _e=g.enums;for(const i in _e){let t=document.body.appendChild(document.createElement("button"));t.innerHTML=i,t.addEventListener("click",()=>{g.set=i})}let F=document.body.appendChild(document.createElement("button"));F.innerHTML="Toggle Touch";F.addEventListener("click",async()=>{d.set=!await d.get});let M=document.body.appendChild(document.createElement("select"));Object.values(P).forEach(i=>{let t=M.appendChild(document.createElement("option"));t.innerHTML=i});M.addEventListener("change",async i=>{v.set=i.currentTarget.selectedOptions[0].innerHTML});(async()=>M.value=await v.get)();let G=document.body.appendChild(document.createElement("button"));G.innerHTML="Scale Down";G.addEventListener("click",async()=>{f.set=await f.get-.2});let q=document.body.appendChild(document.createElement("button"));q.innerHTML="Scale Up";q.addEventListener("click",async()=>{f.set=await f.get+.2});
